newline "; Config end"
identifier "page_table"
keyword_equ "equ"
number_literal "0x03"
newline ""
identifier "mapping_2m"
keyword_equ "equ"
number_literal "0x83"
newline ""
newline ""
identifier "movd"
identifier "eax"
comma ","
number_literal "0x1000"
newline ""
identifier "movw"
l_square_bracket "["
identifier "eax"
plus "+"
number_literal "0x000"
r_square_bracket "]"
comma ","
identifier "page_table"
pipe "|"
number_literal "0x2000"
newline "; Write page table root"
identifier "movw"
l_square_bracket "["
number_literal "0x1FF8"
r_square_bracket "]"
comma ","
identifier "page_table"
pipe "|"
number_literal "0x2000"
newline "; Upper half is same"
identifier "movd"
identifier "cr3"
comma ","
identifier "eax"
newline ""
newline ""
identifier "movw"
identifier "bx"
comma ","
number_literal "0x2018"
newline ""
identifier "movw"
identifier "ax"
comma ","
number_literal "0x6003"
newline ""
identifier "morel1map"
colon ":"
newline ""
identifier "movw"
l_square_bracket "["
identifier "bx"
r_square_bracket "]"
comma ","
identifier "ax"
newline ""
identifier "subb"
identifier "ah"
comma ","
number_literal "0x10"
newline ""
identifier "subb"
identifier "bl"
comma ","
number_literal "8"
newline ""
identifier "jcc"
identifier "morel1map"
newline ""
newline ""
identifier "movw"
l_square_bracket "["
number_literal "0x2FF0"
r_square_bracket "]"
comma ","
identifier "page_table"
pipe "|"
number_literal "0x3000"
newline "; -2G"
identifier "movw"
l_square_bracket "["
number_literal "0x2FF8"
r_square_bracket "]"
comma ","
identifier "page_table"
pipe "|"
number_literal "0x4000"
newline "; -1G"
newline ""
newline "; Indentity map bottom 2G"
identifier "movw"
identifier "di"
comma ","
number_literal "0x3000"
newline ""
identifier "xorw"
identifier "ax"
comma ","
identifier "ax"
newline ""
identifier "moremappings"
colon ":"
newline ""
identifier "movb"
l_square_bracket "["
identifier "di"
r_square_bracket "]"
comma ","
identifier "mapping_2m"
newline "; Third level"
identifier "movw"
l_square_bracket "["
identifier "di"
plus "+"
number_literal "2"
r_square_bracket "]"
comma ","
identifier "ax"
newline ""
identifier "addw"
identifier "di"
comma ","
number_literal "8"
newline ""
identifier "addw"
identifier "ax"
comma ","
number_literal "32"
newline ""
identifier "jcc"
identifier "moremappings"
newline ""
eof ""
